{"version":3,"file":"static/js/876.f9adb17a.chunk.js","mappings":"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","sources":["pages/Profile.js","services/course-service.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport newCourseService from \"../services/course-service\";\r\n\r\nconst Profile = ({ currentUser, allCourses, setAllCourses, filterCategory, setFilterCategory, setCurrentSearch }) => {\r\n    const Navigate = useNavigate();\r\n    const [ errorMsg, setErrorMsg ] = useState(null);\r\n    const [ myCourses, setMyCourses ] = useState([]);\r\n\r\n    const handleSearch = (e) => {\r\n        let result;\r\n        if (e.target.id) { //使用者點到的剛好是 button 那個標籤\r\n            result = filterCategory.filter((i) => i._id === e.target.id);\r\n        } else { //使用者點到 button 標籤底下的任何一個子標籤\r\n            result = filterCategory.filter((i) => i._id === e.target.closest(\"button\").id);\r\n        }\r\n        setCurrentSearch(result);\r\n        localStorage.setItem(\"current_search\", JSON.stringify(result));\r\n        let targetCategories = result[0].category.split(\"、\");\r\n        let newArr = [];\r\n        filterCategory.map((i) => {\r\n            for (let j = 0; j < targetCategories.length; j ++) {\r\n                if (i.category.includes(targetCategories[j])) {\r\n                    console.log(targetCategories[j]);\r\n                    newArr.push(i);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n        setFilterCategory(newArr);\r\n        Navigate(\"/detail\");\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (allCourses.length > 0) {\r\n            let newArr=[];\r\n            setFilterCategory(allCourses);\r\n            currentUser.data.orders.map((i) => {\r\n                let foundCourse = allCourses.filter((j) => i.courseId === j._id);\r\n                let newObj;\r\n                if (newArr.length === 0) {\r\n                    newObj = { course: foundCourse, order: [] };\r\n                } else {\r\n                    let courseHasExisted = false;\r\n                    for (let m = 0; m < newArr.length; m ++) {\r\n                        if (newArr[m].course === foundCourse) {\r\n                            newArr[m].order.push(i);\r\n                            courseHasExisted = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (!courseHasExisted) {\r\n                        newObj = { course: foundCourse, order: [] };\r\n                    }\r\n                }\r\n                newArr.push(newObj);\r\n            });\r\n            setMyCourses(newArr);\r\n        }\r\n    }, [allCourses]);\r\n\r\n    useEffect(() => {\r\n        if (!currentUser) {\r\n            setErrorMsg(\"請先登入或註冊\");\r\n            setTimeout(() => {\r\n                Navigate(\"/login\");\r\n            }, 2000);\r\n        } else {\r\n            newCourseService.searchAllCourses()\r\n            .then((d) => {\r\n                let { newData, profile } = d.data;\r\n                for (let i = 0; i < newData.length; i ++) {\r\n                    newData[i].instructorPhoto = profile[i];\r\n                }\r\n                setAllCourses(newData); // newData 是一整個 array，裡面包含很多個 object，每一個 object 都代表一個課程\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            })\r\n        }\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n\r\n            {!currentUser\r\n            ? <div className=\"error_msg\">{errorMsg}</div>\r\n            : <div>\r\n                <section className=\"py-11\">\r\n                    <div className=\"row\">\r\n                        <div className=\"col-12\">\r\n                            <h2 className=\"col-10 offset-1 fw-bold text-white fs-5 mb-10\">我的課程</h2>\r\n                            \r\n                            {myCourses.length > 0 && myCourses.map((i) =>                            \r\n                            <div className=\"col-10 offset-1 d-flex flex-wrap\">\r\n                                <div className=\"col-12 col-md-4\">\r\n                                    <button type=\"button\" className=\"class-card btn\" id={i.course._id} onClick={handleSearch} key={i.course._id}>\r\n                                        <div className=\"class-card-header\">                                \r\n                                            <img src={i.course.instructorPhoto} alt=\"the instructor\" className=\"profile_img mb-2\" />\r\n                                            <p>{i.course.instructor.name}</p>\r\n                                        </div>\r\n                                        <div className=\"class-card-body text-start\">\r\n                                            <h3 className=\"fw-bold fs-3 text-white\">{i.course.title}</h3>                       \r\n                                            <div className=\"\">\r\n                                                {i.course.category.split(\"、\").map((j) =>\r\n                                                <p className=\"text-primary border border-primary d-inline-block p-1 rounded-0 me-1\" style={{fontSize: \"0.9rem\"}}>{j}</p>\r\n                                                )}\r\n                                            </div>\r\n                                            <p className=\"h-60 h-sm-50 h-md-60 mb-2\">{i.course.description}</p>\r\n                                        </div>\r\n                                        <div className=\"class-card-footer\">\r\n                                            <p className=\"align-self-end mb-1\">{i.course.plan.slice(i.course.plan.indexOf(\"堂\") + 1, i.course.plan.indexOf(\"/\"))}</p>\r\n                                            <p className=\"fs-4 text-white\">{i.course.plan.slice(0, i.course.plan.indexOf(\" \"))}</p>\r\n                                        </div>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"col-12 offset-md-1 col-md-7\">\r\n                                    <p>上課日期: {i.order.date}</p>\r\n                                    <p>上課地址: {i.order.address}</p>\r\n                                    <p>課程方案: {i.order.date}</p>\r\n                                </div>\r\n                            </div>\r\n                            )}\r\n                            \r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </div>}\r\n        \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Profile;","import axios from \"axios\";\r\nconst basic_api = \"https://react-project-2-coding-tutorial-backend.onrender.com/api/course\";\r\n// const basic_api = \"http://localhost:8080/api/course\";\r\n\r\nclass courseService {\r\n    searchAllCourses(limit = 0) {\r\n        console.log(limit);\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            token = JSON.parse(localStorage.getItem(\"user_data\")).token;\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        return axios.get(\r\n            `${basic_api}/search/${limit}`,\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n\r\n    checkOut(ItemName, TotalAmount) {\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            token = JSON.parse(localStorage.getItem(\"user_data\")).token;\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        console.log(\"ask for html from the server\");\r\n        return axios.get(\r\n            `${basic_api}/payment/${ItemName}/${TotalAmount}`,\r\n            { headers: { Authorization: token } }\r\n        )\r\n    }\r\n\r\n    enroll(studentId, courseId, orderDetail, orderPrice) {\r\n        let token;\r\n        localStorage.getItem(\"user_data\")\r\n        ? token = JSON.parse(localStorage.getItem(\"user_data\")).token\r\n        : token = \"\";\r\n        return axios.post(\r\n            `${basic_api}/enroll`,\r\n            { studentId, courseId, orderDetail, orderPrice },\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n\r\n    // getMyOrders(studentId) {\r\n    //     let token;\r\n    //     localStorage.getItem(\"user_data\")\r\n    //     ? token = JSON.parse(localStorage.getItem(\"user_data\")).token\r\n    //     : token = \"\";\r\n    //     return axios.get(\r\n    //         `${basic_api}/getMyOrders/${studentId}`,\r\n    //         { headers: { Authorization: token } }\r\n    //     );\r\n    // }\r\n}\r\n\r\nconst newCourseService = new courseService();\r\nexport default newCourseService;"],"names":["_ref","currentUser","allCourses","setAllCourses","filterCategory","setFilterCategory","setCurrentSearch","Navigate","useNavigate","_useState","useState","_useState2","_slicedToArray","errorMsg","setErrorMsg","_useState3","_useState4","myCourses","setMyCourses","handleSearch","e","result","target","id","filter","i","_id","closest","localStorage","setItem","JSON","stringify","targetCategories","category","split","newArr","map","j","length","includes","console","log","push","useEffect","data","orders","newObj","foundCourse","courseId","course","order","courseHasExisted","m","newCourseService","searchAllCourses","then","d","_d$data","newData","profile","instructorPhoto","catch","setTimeout","_jsx","className","children","_jsxs","type","onClick","src","alt","instructor","name","title","style","fontSize","description","plan","slice","indexOf","date","address","basic_api","courseService","_classCallCheck","_createClass","key","value","token","limit","arguments","undefined","getItem","parse","axios","get","concat","headers","Authorization","ItemName","TotalAmount","studentId","orderDetail","orderPrice","post"],"sourceRoot":""}