{"version":3,"file":"static/js/787.5e706f44.chunk.js","mappings":"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","sources":["assets/images/icon_fb.svg","pages/Login.js"],"sourcesContent":["var _g;\nvar _excluded = [\"title\", \"titleId\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from \"react\";\nfunction SvgIconFb(_ref, svgRef) {\n  var title = _ref.title,\n    titleId = _ref.titleId,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    height: 512,\n    viewBox: \"0 0 176 176\",\n    width: 512,\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Layer_2\",\n    \"data-name\": \"Layer 2\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"_01.facebook\",\n    \"data-name\": \"01.facebook\"\n  }, /*#__PURE__*/React.createElement(\"circle\", {\n    id: \"background\",\n    cx: 88,\n    cy: 88,\n    fill: \"#3a559f\",\n    r: 88\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon\",\n    d: \"m115.88 77.58-1.77 15.33a2.87 2.87 0 0 1 -2.82 2.57h-16l-.08 45.45a2.05 2.05 0 0 1 -2 2.07h-16.21a2 2 0 0 1 -2-2.08v-45.44h-12a2.87 2.87 0 0 1 -2.84-2.9l-.06-15.33a2.88 2.88 0 0 1 2.84-2.92h12.06v-14.8c0-17.18 10.2-26.53 25.16-26.53h12.26a2.88 2.88 0 0 1 2.85 2.92v12.9a2.88 2.88 0 0 1 -2.85 2.92h-7.52c-8.13 0-9.71 4-9.71 9.78v12.81h17.87a2.88 2.88 0 0 1 2.82 3.25z\",\n    fill: \"#fff\"\n  })))));\n}\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgIconFb);\nexport default __webpack_public_path__ + \"static/media/icon_fb.2e02184f0e9670d6a01f25ca0d4b4d3b.svg\";\nexport { ForwardRef as ReactComponent };","import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { GoogleLogin } from \"@react-oauth/google\";\r\nimport axios from \"axios\";\r\nimport newAuthService from \"../services/auth-service\";\r\nimport icon_fb from \"../assets/images/icon_fb.svg\";\r\n\r\nconst Login = ({ currentUser, setCurrentUser }) => {\r\n    const Navigate = useNavigate();\r\n    const [ email, setEmail ] = useState(\"\");\r\n    const [ password, setPassword ] = useState(\"\");\r\n    const [ errorMsg, setErrorMsg ] = useState(null);\r\n    const [ successMsg, setSuccessMsg ] = useState(null);\r\n\r\n    const changeEmail = (e) => {\r\n        setEmail(e.target.value);\r\n    }\r\n    const changePassword = (e) => {\r\n        setPassword(e.target.value);\r\n    }\r\n\r\n    const changePswVisibility = (e) => {\r\n        console.log(e.target);\r\n        let pwd = document.querySelector(\"#password\");\r\n        pwd.type === \"password\"\r\n        ? pwd.type = \"text\"\r\n        : pwd.type = \"password\";\r\n    }\r\n\r\n    // 本地登入\r\n    const handleLogin = (e) => {\r\n        e.preventDefault();\r\n        let emailInputTag = document.querySelector(\"#email\");\r\n        console.log(emailInputTag.validity);\r\n        if (email.length === 0 || emailInputTag.validity.patternMismatch) {\r\n            return setErrorMsg(\"信箱格式錯誤\");\r\n        } else if (password.length < 8) {\r\n            return setErrorMsg(\"密碼至少需為 8 位數\");\r\n        }\r\n        newAuthService.login(email, password)\r\n        .then((d) => {\r\n            setErrorMsg(null);\r\n            setSuccessMsg(d.data.msg);\r\n            setTimeout(() => {\r\n                localStorage.setItem(\"user_data\", JSON.stringify(d.data));\r\n                let currentUser = newAuthService.getCurrentUser(); //不涉及 db 所以回傳資料的形式不是 promise，不用 .then .catch\r\n                setCurrentUser(currentUser);      \r\n                setSuccessMsg(null);\r\n                Navigate(\"/profile\");\r\n            }, 2000);\r\n        })\r\n        .catch((e) => {\r\n            console.log(e);\r\n            setErrorMsg(e.response.data);\r\n        })\r\n    }\r\n\r\n    // Facebook 登入\r\n    const handleLoginWithFacebook = () => {\r\n        window.FB.login(\r\n            function(response) {\r\n                let accessToken = response.authResponse.accessToken;\r\n                if (response.status === \"connected\") {\r\n                    window.FB.api(\"/me\", \"GET\", { fields: \"name,email\" }, (userData) => {\r\n                        newAuthService.loginWithFacebook(accessToken, userData)\r\n                        .then((d) => {\r\n                            setCurrentUser(d.data);\r\n                            localStorage.setItem(\"user_data\", JSON.stringify(d.data));\r\n                            Navigate(\"/profile\");\r\n                        })\r\n                        .catch((e) => {\r\n                            console.log(e);\r\n                        })        \r\n                    })              \r\n                }\r\n            },\r\n            { scope: \"public_profile,email\" }\r\n        );\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (currentUser && currentUser.access_token) { // 向 Google 拿使用者的資料\r\n            axios.get(\r\n                `https://www.googleapis.com/oauth2/v1/userinfo?access_token=${currentUser.access_token}`,\r\n                { headers: { Authorization: `Bearer ${currentUser.access_token}`, Accept: \"application/json\" } }\r\n            )\r\n            .then((res) => {\r\n                console.log(\"res: \", res);\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            })\r\n        }\r\n    }, [currentUser]);\r\n\r\n    useEffect(() => {    \r\n        if (currentUser) {\r\n            setErrorMsg(\"您已經登入過囉 ! 將為您導向個人頁面\");\r\n            setTimeout(() => {\r\n                setErrorMsg(null);\r\n                Navigate(\"/profile\");\r\n            }, 2000);\r\n        } else {\r\n            // Facebook 登入初始化\r\n            window.fbAsyncInit = function() {\r\n                window.FB.init({\r\n                    appId: process.env.REACT_APP_FACEBOOK_LOGIN_APPID,\r\n                    cookie: true,\r\n                    xfbml: true,\r\n                    version: \"v18.0\",\r\n                });\r\n                window.FB.AppEvents.logPageView();\r\n            };\r\n            (function(d, s, id) {\r\n                let js;\r\n                let fjs = d.getElementsByTagName(s)[0];\r\n                if (d.getElementById(id)) {\r\n                    return;\r\n                }\r\n                js = d.createElement(s);\r\n                js.id = id;\r\n                js.src = \"https://connect.facebook.net/en_US/sdk.js\";\r\n                fjs.parentNode.insertBefore(js, fjs);\r\n            }(document, \"script\", \"facebook-jssdk\"));\r\n        }\r\n    }, []);\r\n    let googleDiv = document.querySelector(\"#ssJRIf\");\r\n    console.log(googleDiv);\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n\r\n            {errorMsg && (\r\n                <div className=\"error_msg\">{errorMsg}</div>\r\n            )}\r\n\r\n            {successMsg && (\r\n                <div className=\"success_msg\">{successMsg}</div>\r\n            )}\r\n\r\n            {!currentUser && (\r\n            <div>\r\n                <section className=\"my-11\">\r\n                    <form>\r\n                        <div className=\"mb-6\">\r\n                            <label htmlFor=\"email\" className=\"form-label\">信箱</label>\r\n                            <input type=\"email\" className=\"form-control px-3 py-2\" id=\"email\" name=\"email\" placeholder=\"example@gmail.com\" required max=\"60\" pattern=\".+@.+\\.+.{2,}\" onChange={changeEmail} />\r\n                        </div>\r\n                        <div className=\"mb-11\">\r\n                            <div className=\"position-relative\">\r\n                                <label htmlFor=\"password\" className=\"form-label\">密碼</label>\r\n                                <input type=\"password\" className=\"form-control py-2 ps-3\" id=\"password\" name=\"password\" required min=\"8\" onChange={changePassword} />\r\n                                <button type=\"button\" className=\"btn p-0 position-absolute end-0 ms-2 me-2 me-sm-4\" style={{top: \"46%\"}} >\r\n                                    <span class=\"material-symbols-outlined font-fill-1 p-2\" onClick={changePswVisibility} >\r\n                                        visibility\r\n                                    </span>\r\n                                </button>\r\n                            </div>\r\n                            <p className=\"mt-3\">8位數以上，至少一個大寫英文字母、一個數字、一個特殊符號(僅限<span className=\"text-warning\">!@#%&=_?</span>)且<span className=\"text-warning\">不可有空格</span></p>\r\n                        </div>\r\n                        <button type=\"submit\" className=\"btn bg-linear text-white border-0 rounded-1\" style={{paddingTop: \"0.625rem\", paddingBottom: \"0.625rem\", width: \"200px\", height: \"40px\"}} onClick={handleLogin}>登入</button>\r\n                    </form>\r\n                </section>\r\n                <section>\r\n                    <div className=\"border-top position-relative d-flex justify-content-center\">\r\n                        <p className=\"position-absolute px-5 bg-fourth\" style={{transform: \"translateY(-50%)\"}}>其它登入方式</p>\r\n                    </div>\r\n                    <div className=\"d-flex mt-12 flex-wrap\">\r\n                        <button type=\"button\" className=\"btn border bg-white text-dark me-5 mb-4 mb-sm-0 rounded-1\" style={{fontSize: \"14px\", width: \"200px\", height: \"40px\", fontFamily: \"sans-serif\", paddingRight: \"6px\", paddingLeft: \"6px\" }} onClick={handleLoginWithFacebook}>\r\n                            <img src={icon_fb} alt=\"Facebook icon\" style={{marginRight: \"8px\", height: \"18px\"}} />\r\n                            使用 Facebook 帳戶登入\r\n                        </button>\r\n                        <GoogleLogin\r\n                            onSuccess={credentialResponse => {\r\n                                newAuthService.loginWithGoogle(credentialResponse.credential)\r\n                                .then((d) => {\r\n                                    localStorage.setItem(\"user_data\", JSON.stringify(d.data));\r\n                                    setCurrentUser(newAuthService.getCurrentUser());\r\n                                    setErrorMsg(null);\r\n                                    Navigate(\"/profile\");\r\n                                })\r\n                                .catch((e) => {\r\n                                    console.log(e);\r\n                                })\r\n                            }}\r\n                            onError={() => {\r\n                                console.log('Login Failed');\r\n                            }}\r\n                            width=\"200px\"\r\n                        ></GoogleLogin>\r\n                    </div>\r\n                </section>\r\n            </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login;"],"names":["_ref","currentUser","setCurrentUser","Navigate","useNavigate","_useState","useState","_useState2","_slicedToArray","email","setEmail","_useState3","_useState4","password","setPassword","_useState5","_useState6","errorMsg","setErrorMsg","_useState7","_useState8","successMsg","setSuccessMsg","useEffect","access_token","axios","get","concat","headers","Authorization","Accept","then","res","console","log","catch","e","setTimeout","window","fbAsyncInit","FB","init","appId","process","cookie","xfbml","version","AppEvents","logPageView","d","s","id","js","fjs","getElementsByTagName","getElementById","createElement","src","parentNode","insertBefore","document","googleDiv","querySelector","_jsxs","className","children","_jsx","htmlFor","type","name","placeholder","required","max","pattern","onChange","target","value","min","style","top","class","onClick","pwd","paddingTop","paddingBottom","width","height","preventDefault","emailInputTag","validity","length","patternMismatch","newAuthService","login","data","msg","localStorage","setItem","JSON","stringify","getCurrentUser","response","transform","fontSize","fontFamily","paddingRight","paddingLeft","accessToken","authResponse","status","api","fields","userData","loginWithFacebook","scope","icon_fb","alt","marginRight","GoogleLogin","onSuccess","credentialResponse","loginWithGoogle","credential","onError"],"sourceRoot":""}