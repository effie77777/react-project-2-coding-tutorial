{"version":3,"file":"static/js/876.a1aa07ee.chunk.js","mappings":"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","sources":["pages/Profile.js","services/course-service.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport newCourseService from \"../services/course-service\";\r\n\r\nconst Profile = ({ currentUser, allCourses, setAllCourses, filterCategory, setFilterCategory, setCurrentSearch }) => {\r\n    const Navigate = useNavigate();\r\n    const [ errorMsg, setErrorMsg ] = useState(null);\r\n    const [ myCourses, setMyCourses ] = useState([]);\r\n\r\n    const handleSearch = (e) => {\r\n        let result = filterCategory.filter((i) => i._id === e.target.id);\r\n        setCurrentSearch(result);\r\n        localStorage.setItem(\"current_search\", JSON.stringify(result));\r\n        let targetCategories = result[0].category.split(\"、\");\r\n        let newArr = [];\r\n        filterCategory.map((i) => {\r\n            for (let j = 0; j < targetCategories.length; j ++) {\r\n                if (i.category.includes(targetCategories[j])) {\r\n                    console.log(targetCategories[j]);\r\n                    newArr.push(i);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n        setFilterCategory(newArr);\r\n        Navigate(\"/detail\");\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (allCourses.length > 0) {\r\n            setFilterCategory(allCourses);\r\n        }\r\n    }, [allCourses]);\r\n\r\n    useEffect(() => {\r\n        if (!currentUser) {\r\n            setErrorMsg(\"請先登入或註冊\");\r\n            setTimeout(() => {\r\n                Navigate(\"/login\");\r\n            }, 2000);\r\n        } else {\r\n            newCourseService.searchAllCourses(\"unlimited\")\r\n            .then((d) => {\r\n                let { newData, profile } = d.data;\r\n                for (let i = 0; i < newData.length; i ++) {\r\n                    newData[i].instructorPhoto = profile[i];\r\n                }\r\n                setAllCourses(newData); // newData 是一整個 array，裡面包含很多個 object，每一個 object 都代表一個課程\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            })\r\n            newCourseService.getMyOrders(currentUser.data._id)\r\n            .then((d) => {\r\n                setMyCourses(d.data);\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            })\r\n        }\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n\r\n            {!currentUser\r\n            ? <div className=\"error_msg\">{errorMsg}</div>\r\n            : <div>\r\n                <section className=\"py-11\">\r\n                    <div className=\"row\">\r\n                        <div className=\"col-12\">\r\n                            <h3 className=\"col-10 offset-1 fw-bold text-white fs-5 mb-10\">我的課程</h3>\r\n                            <div className=\"col-10 offset-1\">\r\n                            \r\n                                {myCourses.length > 0 && myCourses.map((i) =>                            \r\n                                <div className=\"d-flex flex-column flex-md-row py-4 px-6 border mb-6\" key={i.courseId}>\r\n                                    <div className=\"d-flex flex-column flex-lg-row flex-grow-1 profile-card-div\">\r\n                                        <div className=\"w-lg-50\">\r\n                                            <p className=\"mb-3\">{i.courseTitle} ({i.instructor})</p>\r\n                                            <p className=\"mb-3 mb-lg-0\">課程方案: 共 {i.plan} 堂</p>\r\n                                        </div>\r\n                                        <div className=\"w-lg-50\">                 \r\n                                            <p className=\"mb-3\">上課日期: {i.date}</p>                       \r\n                                            <p className=\"pb-4 pb-md-0 profile-card-p\">上課地點: {i.address}</p>\r\n                                        </div>\r\n                                    </div>                 \r\n                                    <button type=\"button\" className=\"btn rounded-0 text-start text-md-center mt-4 mt-md-0 flex-shrink-0 profile-card-btn\" id={i.courseId} onClick={handleSearch}>\r\n                                        查看課程詳細資訊\r\n                                    </button>\r\n                                </div>\r\n                                )}\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </div>}\r\n        \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Profile;","import axios from \"axios\";\r\nconst basic_api = \"https://react-project-2-coding-tutorial-backend.onrender.com/api/course\";\r\n// const basic_api = \"http://localhost:8080/api/course\";\r\n\r\nclass courseService {\r\n    searchAllCourses() {\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            token = JSON.parse(localStorage.getItem(\"user_data\")).token;\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        return axios.get(\r\n            `${basic_api}/search`,\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n\r\n    // 準備結帳\r\n    checkOut(ItemName, TotalAmount) {\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            token = JSON.parse(localStorage.getItem(\"user_data\")).token;\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        return axios.get(\r\n            `${basic_api}/payment/${ItemName}/${TotalAmount}`,\r\n            { headers: { Authorization: token } }\r\n        )\r\n    }\r\n\r\n    // 付款成功後\r\n    enroll(studentId, course, orderDetail, classAmounts) {\r\n        let token;\r\n        localStorage.getItem(\"user_data\")\r\n        ? token = JSON.parse(localStorage.getItem(\"user_data\")).token\r\n        : token = \"\";\r\n        return axios.post(\r\n            `${basic_api}/enroll`,\r\n            { studentId, course, orderDetail, classAmounts },\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n\r\n    getMyOrders(studentId) {\r\n        console.log(studentId);\r\n        let token;\r\n        localStorage.getItem(\"user_data\")\r\n        ? token = JSON.parse(localStorage.getItem(\"user_data\")).token\r\n        : token = \"\";\r\n        return axios.get(\r\n            `${basic_api}/getMyOrders/${studentId}`,\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n}\r\n\r\nconst newCourseService = new courseService();\r\nexport default newCourseService;"],"names":["_ref","currentUser","allCourses","setAllCourses","filterCategory","setFilterCategory","setCurrentSearch","Navigate","useNavigate","_useState","useState","_useState2","_slicedToArray","errorMsg","setErrorMsg","_useState3","_useState4","myCourses","setMyCourses","handleSearch","e","result","filter","i","_id","target","id","localStorage","setItem","JSON","stringify","targetCategories","category","split","newArr","map","j","length","includes","console","log","push","useEffect","newCourseService","searchAllCourses","then","d","_d$data","data","newData","profile","instructorPhoto","catch","getMyOrders","setTimeout","_jsx","className","children","_jsxs","courseTitle","instructor","plan","date","address","type","courseId","onClick","basic_api","courseService","_classCallCheck","_createClass","key","value","token","getItem","parse","axios","get","concat","headers","Authorization","ItemName","TotalAmount","studentId","course","orderDetail","classAmounts","post"],"sourceRoot":""}