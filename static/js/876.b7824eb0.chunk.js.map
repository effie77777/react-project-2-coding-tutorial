{"version":3,"file":"static/js/876.b7824eb0.chunk.js","mappings":"+KAyGA,UArGgB,SAAHA,GAAyG,IAAnGC,EAAWD,EAAXC,YAAaC,EAAUF,EAAVE,WAAYC,EAAaH,EAAbG,cAAeC,EAAcJ,EAAdI,eAAgBC,EAAiBL,EAAjBK,kBAAmBC,EAAgBN,EAAhBM,iBACpFC,GAAWC,EAAAA,EAAAA,MACjBC,GAAkCC,EAAAA,EAAAA,UAAS,MAAKC,GAAAC,EAAAA,EAAAA,GAAAH,EAAA,GAAxCI,EAAQF,EAAA,GAAEG,EAAWH,EAAA,GAC7BI,GAAoCL,EAAAA,EAAAA,UAAS,IAAGM,GAAAJ,EAAAA,EAAAA,GAAAG,EAAA,GAAxCE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAEzBG,EAAe,SAACC,GAClB,IAAIC,EAEAA,EADAD,EAAEE,OAAOC,GACAnB,EAAeoB,QAAO,SAACC,GAAC,OAAKA,EAAEC,MAAQN,EAAEE,OAAOC,EAAE,IAElDnB,EAAeoB,QAAO,SAACC,GAAC,OAAKA,EAAEC,MAAQN,EAAEE,OAAOK,QAAQ,UAAUJ,EAAE,IAEjFjB,EAAiBe,GACjBO,aAAaC,QAAQ,iBAAkBC,KAAKC,UAAUV,IACtD,IAAIW,EAAmBX,EAAO,GAAGY,SAASC,MAAM,UAC5CC,EAAS,GACb/B,EAAegC,KAAI,SAACX,GAChB,IAAK,IAAIY,EAAI,EAAGA,EAAIL,EAAiBM,OAAQD,IACzC,GAAIZ,EAAEQ,SAASM,SAASP,EAAiBK,IAAK,CAC1CG,QAAQC,IAAIT,EAAiBK,IAC7BF,EAAOO,KAAKjB,GACZ,KACJ,CAER,IACApB,EAAkB8B,GAClB5B,EAAS,UACb,EA4BA,OA1BAoC,EAAAA,EAAAA,YAAU,WACFzC,EAAWoC,OAAS,IACpBpB,EAAahB,EAAWsB,QAAO,SAACC,GAAC,OAAKA,EAAEmB,SAASL,SAAStC,EAAY4C,KAAKnB,IAAI,KAC/ErB,EAAkBH,GAE1B,GAAG,CAACA,KAEJyC,EAAAA,EAAAA,YAAU,WACD1C,GAGDa,EAAY,MACZgC,EAAAA,EAAiBC,mBAChBC,MAAK,SAACC,GAEH,IADA,IAAAC,EAA2BD,EAAEJ,KAAvBM,EAAOD,EAAPC,QAASC,EAAOF,EAAPE,QACN3B,EAAI,EAAGA,EAAI0B,EAAQb,OAAQb,IAChC0B,EAAQ1B,GAAG4B,gBAAkBD,EAAQ3B,GAEzCtB,EAAcgD,EAClB,IACCG,OAAM,SAAClC,GACJoB,QAAQC,IAAIrB,EAChB,KAbAN,EAAY,yDAepB,GAAG,KAGCyC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBC,SAAA,CAE/B5C,IACG6C,EAAAA,EAAAA,KAAA,OAAKF,UAAU,YAAWC,SAAE5C,IAG/BZ,IACDyD,EAAAA,EAAAA,KAAA,WAASF,UAAU,QAAOC,UACtBC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,MAAKC,UAChBF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,SAAQC,SAAA,EACnBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,gDAA+CC,SAAC,8BAC9DC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mEAAkEC,SAE5ExC,EAAUqB,OAAS,GAAKrB,EAAUmB,KAAI,SAACX,GAAC,OACzC8B,EAAAA,EAAAA,MAAA,UAAQI,KAAK,SAASH,UAAU,iBAAiBjC,GAAIE,EAAEC,IAAKkC,QAASzC,EAAasC,SAAA,EAC9EF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAC9BC,EAAAA,EAAAA,KAAA,OAAKG,IAAKpC,EAAE4B,gBAAiBS,IAAI,iBAAiBN,UAAU,sBAC5DE,EAAAA,EAAAA,KAAA,KAAAD,SAAIhC,EAAEsC,WAAWC,WAErBT,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BC,SAAA,EACvCC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,0BAAyBC,SAAEhC,EAAEwC,SAC3CP,EAAAA,EAAAA,KAAA,OAAKF,UAAU,GAAEC,SACZhC,EAAEQ,SAASC,MAAM,UAAKE,KAAI,SAACX,GAAC,OAC7BiC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,uEAAuEU,MAAO,CAACC,SAAU,UAAUV,SAAEhC,GAAM,OAG5HiC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,4BAA2BC,SAAEhC,EAAE2C,kBAEhDb,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBC,SAAA,EAC9BC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,sBAAqBC,SAAEhC,EAAE4C,KAAKC,MAAM7C,EAAE4C,KAAKE,QAAQ,UAAO,EAAG9C,EAAE4C,KAAKE,QAAQ,SACzFb,EAAAA,EAAAA,KAAA,KAAGF,UAAU,kBAAiBC,SAAEhC,EAAE4C,KAAKC,MAAM,EAAG7C,EAAE4C,KAAKE,QAAQ,aAhBiB9C,EAAEC,IAkBjF,eAWjC,C,yDCrGM8C,EAAY,mCAiDZ1B,EAAmB,IA/CN,oBAAA2B,KAAAC,EAAAA,EAAAA,GAAA,KAAAD,EAAA,CA4Cd,OA5CcE,EAAAA,EAAAA,GAAAF,EAAA,EAAAG,IAAA,mBAAAC,MACf,WACI,IAAIC,EACAlD,aAAamD,QAAQ,aAGjBD,EAFShD,KAAKkD,MAAMpD,aAAamD,QAAQ,cAE1BD,MAKnBA,EAAQ,GAEZ,OAAOG,EAAAA,EAAMC,IAAI,GAADC,OACTX,EAAS,WACZ,CAAEY,QAAS,CAAEC,cAAeP,IAEpC,GAAC,CAAAF,IAAA,WAAAC,MAED,SAASS,EAAUC,GAEf,IAAIT,EAMJ,OAPAtC,QAAQC,IAAI,kBAGRqC,EADAlD,aAAamD,QAAQ,aACbjD,KAAKkD,MAAMpD,aAAamD,QAAQ,cAAcD,MAE9C,GAELG,EAAAA,EAAMC,IAAI,GAADC,OACTX,EAAS,aAAAW,OAAYG,EAAQ,KAAAH,OAAII,GACpC,CAAEH,QAAS,CAAEC,cAAeP,IAEpC,GAAC,CAAAF,IAAA,SAAAC,MAED,SAAOW,EAAWC,GAEd,IAAIX,EAIJ,OALAtC,QAAQC,IAAI+C,EAAWC,GAGrBX,EADFlD,aAAamD,QAAQ,aACXjD,KAAKkD,MAAMpD,aAAamD,QAAQ,cAAcD,MAC9C,GACHG,EAAAA,EAAMS,KAAK,GAADP,OACVX,EAAS,WACZ,CAAEgB,UAAAA,EAAWC,SAAAA,GACb,CAAEL,QAAS,CAAEC,cAAeP,IAEpC,KAACL,CAAA,CA5Cc,IAgDnB,K","sources":["pages/Profile.js","services/course-service.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport newCourseService from \"../services/course-service\";\r\n\r\nconst Profile = ({ currentUser, allCourses, setAllCourses, filterCategory, setFilterCategory, setCurrentSearch }) => {\r\n    const Navigate = useNavigate();\r\n    const [ errorMsg, setErrorMsg ] = useState(null);\r\n    const [ myCourses, setMyCourses ] = useState([]);\r\n\r\n    const handleSearch = (e) => {\r\n        let result;\r\n        if (e.target.id) { //使用者點到的剛好是 button 那個標籤\r\n            result = filterCategory.filter((i) => i._id === e.target.id);\r\n        } else { //使用者點到 button 標籤底下的任何一個子標籤\r\n            result = filterCategory.filter((i) => i._id === e.target.closest(\"button\").id);\r\n        }\r\n        setCurrentSearch(result);\r\n        localStorage.setItem(\"current_search\", JSON.stringify(result));\r\n        let targetCategories = result[0].category.split(\"、\");\r\n        let newArr = [];\r\n        filterCategory.map((i) => {\r\n            for (let j = 0; j < targetCategories.length; j ++) {\r\n                if (i.category.includes(targetCategories[j])) {\r\n                    console.log(targetCategories[j]);\r\n                    newArr.push(i);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n        setFilterCategory(newArr);\r\n        Navigate(\"/detail\");\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (allCourses.length > 0) {\r\n            setMyCourses(allCourses.filter((i) => i.students.includes(currentUser.data._id)));\r\n            setFilterCategory(allCourses);\r\n        }\r\n    }, [allCourses]);\r\n\r\n    useEffect(() => {\r\n        if (!currentUser) {\r\n            setErrorMsg(\"請先進行登入或註冊\")\r\n        } else { // Google 登入的使用者才有 access_token，也就是本地登入的使用者需要跑 newAuthService\r\n            setErrorMsg(null);\r\n            newCourseService.searchAllCourses()\r\n            .then((d) => {\r\n                let { newData, profile } = d.data;\r\n                for (let i = 0; i < newData.length; i ++) {\r\n                    newData[i].instructorPhoto = profile[i];\r\n                }\r\n                setAllCourses(newData); // newData 是一整個 array，裡面包含很多個 object，每一個 object 都代表一個課程\r\n            })\r\n            .catch((e) => {\r\n                console.log(e);\r\n            })\r\n        }\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n\r\n        {errorMsg && (\r\n            <div className=\"error_msg\">{errorMsg}</div>\r\n        )}\r\n\r\n        {currentUser && (\r\n        <section className=\"py-11\">\r\n            <div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    <h2 className=\"col-10 offset-1 fw-bold text-white fs-5 mb-10\">我的課程</h2>\r\n                    <div className=\"col-10 offset-1 d-flex flex-wrap flex-md-nowrap overflow-md-auto\">\r\n\r\n                        {myCourses.length > 0 && myCourses.map((i) =>\r\n                        <button type=\"button\" className=\"class-card btn\" id={i._id} onClick={handleSearch} key={i._id}>\r\n                            <div className=\"class-card-header\">                                \r\n                                <img src={i.instructorPhoto} alt=\"the instructor\" className=\"profile_img mb-2\" />\r\n                                <p>{i.instructor.name}</p>\r\n                            </div>\r\n                            <div className=\"class-card-body text-start\">\r\n                                <h3 className=\"fw-bold fs-3 text-white\">{i.title}</h3>                       \r\n                                <div className=\"\">\r\n                                    {i.category.split(\"、\").map((i) =>\r\n                                    <p className=\"text-primary border border-primary d-inline-block p-1 rounded-0 me-1\" style={{fontSize: \"0.9rem\"}}>{i}</p>\r\n                                    )}\r\n                                </div>\r\n                                <p className=\"h-60 h-sm-50 h-md-60 mb-2\">{i.description}</p>\r\n                            </div>\r\n                            <div className=\"class-card-footer\">\r\n                                <p className=\"align-self-end mb-1\">{i.plan.slice(i.plan.indexOf(\"堂\") + 1, i.plan.indexOf(\"/\"))}</p>\r\n                                <p className=\"fs-4 text-white\">{i.plan.slice(0, i.plan.indexOf(\" \"))}</p>\r\n                            </div>\r\n                        </button>\r\n                        )}\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        )}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Profile;","import axios from \"axios\";\r\n// const basic_api = \"https://react-project-2-coding-tutorial-backend.onrender.com/api/course\";\r\nconst basic_api = \"http://localhost:8080/api/course\";\r\n\r\nclass courseService {\r\n    searchAllCourses() {\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            let parsed = JSON.parse(localStorage.getItem(\"user_data\"));\r\n            // if (parsed.token) {\r\n                token = parsed.token;\r\n            // } else if (parsed.access_token) {\r\n            //     token = parsed.access_token;\r\n            // }\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        return axios.get(\r\n            `${basic_api}/search`,\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n\r\n    checkOut(ItemName, TotalAmount) {\r\n        console.log(\"inside service\");\r\n        let token;\r\n        if (localStorage.getItem(\"user_data\")) {\r\n            token = JSON.parse(localStorage.getItem(\"user_data\")).token;\r\n        } else {\r\n            token = \"\";\r\n        }\r\n        return axios.get(\r\n            `${basic_api}/payment/${ItemName}/${TotalAmount}`,\r\n            { headers: { Authorization: token } }\r\n        )\r\n    }\r\n\r\n    enroll(studentId, courseId) {\r\n        console.log(studentId, courseId);\r\n        let token;\r\n        localStorage.getItem(\"user_data\")\r\n        ? token = JSON.parse(localStorage.getItem(\"user_data\")).token\r\n        : token = \"\";\r\n        return axios.post(\r\n            `${basic_api}/enroll`,\r\n            { studentId, courseId },\r\n            { headers: { Authorization: token } }\r\n        );\r\n    }\r\n}\r\n\r\nconst newCourseService = new courseService();\r\nexport default newCourseService;"],"names":["_ref","currentUser","allCourses","setAllCourses","filterCategory","setFilterCategory","setCurrentSearch","Navigate","useNavigate","_useState","useState","_useState2","_slicedToArray","errorMsg","setErrorMsg","_useState3","_useState4","myCourses","setMyCourses","handleSearch","e","result","target","id","filter","i","_id","closest","localStorage","setItem","JSON","stringify","targetCategories","category","split","newArr","map","j","length","includes","console","log","push","useEffect","students","data","newCourseService","searchAllCourses","then","d","_d$data","newData","profile","instructorPhoto","catch","_jsxs","className","children","_jsx","type","onClick","src","alt","instructor","name","title","style","fontSize","description","plan","slice","indexOf","basic_api","courseService","_classCallCheck","_createClass","key","value","token","getItem","parse","axios","get","concat","headers","Authorization","ItemName","TotalAmount","studentId","courseId","post"],"sourceRoot":""}